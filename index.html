<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Google Sheets Viewer</title>
  <style>
    body { font-family: sans-serif; background: #f9f9f9; margin: 0; padding: 1em; }
    .sheet { margin-bottom: 3em; }
    table { border-collapse: collapse; box-shadow: 0 0 4px #ccc; }
    td, th {
      border: 1px solid #ccc;
      padding: 4px 8px;
      position: relative;
      white-space: pre-wrap;
      max-width: 300px;
    }
    td[title]::after {
      content: 'ðŸ“Œ';
      position: absolute;
      top: 2px;
      right: 4px;
      font-size: 0.8em;
    }
  </style>
</head>
<body>
  <div id="content">Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ‚Ð°Ð±Ð»Ð¸Ñ†...</div>
  <script>
    async function fetchSheets() {
      const res = await fetch('https://fw-economy.rayzomov551.workers.dev');
      const sheets = await res.json();

      const container = document.getElementById('content');
      container.innerHTML = '';

      sheets.forEach(sheet => {
        const div = document.createElement('div');
        div.className = 'sheet';

        const h2 = document.createElement('h2');
        h2.textContent = sheet.title;
        div.appendChild(h2);

        const table = document.createElement('table');
        sheet.data.forEach(row => {
          const tr = document.createElement('tr');
          (row?.values || []).forEach(cell => {
            const td = document.createElement('td');
            td.textContent = cell.formattedValue ?? '';

            if (cell.note) {
              td.title = cell.note;
              td.style.background = '#ffffcc';
            }

            if (cell.effectiveFormat?.backgroundColorStyle?.rgbColor) {
              const c = cell.effectiveFormat.backgroundColorStyle.rgbColor;
              td.style.backgroundColor = `rgba(${(c.red||0)*255}, ${(c.green||0)*255}, ${(c.blue||0)*255}, ${c.alpha ?? 1})`;
            }

            tr.appendChild(td);
          });
          table.appendChild(tr);
        });

        div.appendChild(table);
        container.appendChild(div);
      });
    }

    fetchSheets();
    setInterval(fetchSheets, 10000);
  </script>
</body>
</html>
